{"version":3,"file":"app.js","names":[],"mappings":"","sources":["app.coffee"],"sourcesContent":["define [\n\t\"jquery\"\n\t\"TweenMax\"\n\t\"TimelineLite\"\n\t\"utils/Ajax\"\n], ($,TweenMax,TimelineLite,Ajax) ->\n\n\tclass App\n\n\t\t_code : null\n\t\t_guests : null\n\t\t_guest : null\n\n\t\t_forceStart : null\n\n\t\t_cardAnimation : null\n\t\t_flapAnimation : null\n\n\t\tconstructor: ->\n\n\t\t\tsearch = window.location.search\n\n\t\t\tif search? and search isnt \"\"\n\t\t\t\tmatchSearch = search.match(/\\?(.*?)\\&/) || search.match(/\\?(.*)/)\n\t\t\t\t@_code = matchSearch[1]\n\t\t\t\t@_getGuestsData()\n\t\t\telse\n\t\t\t\t@_onGuestNotFound()\n\n\t\t_getGuestsData: ->\n\n\t\t\tAjax.get \"../data/guests.json\", @_onGuestsDataSuccess, @_onGuestsDataError\n\n\t\t_onGuestsDataSuccess: (data) =>\n\n\t\t\t@_guests = data.guests\n\n\t\t\t@_findGuest()\n\n\t\t_onGuestsDataError: (e) ->\n\n\t\t\t@_onGuestNotFound()\n\n\t\t_findGuest: ->\n\n\t\t\t@_guest = @_guests.filter((element) =>\n\t\t\t\telement.code is @_code)[0]\n\n\t\t\tif @_guest?\n\t\t\t\t$(\".addressee h2\").html (\"#{@_guest.name}\")\n\t\t\t\t@_start()\n\t\t\telse\n\t\t\t\t@_onGuestNotFound()\n\n\t\t_start: ->\n\n\t\t\t@_addListeners()\n\t\t\t@_setupElements()\n\n\t\t\t@_forceStart = setTimeout =>\n\t\t\t\t@_flipEnvelope()\n\t\t\t,2000\n\n\t\t_addListeners: ->\n\n\t\t\t$(\".card-container\").on \"mouseover\", @_onCardContainerHover\n\n\t\t_setupElements: ->\n\n\t\t\tTweenMax.set \".card-container\", {perspective:1000}\n\t\t\tTweenMax.set \".tent-canvas\", {skewX:\"30deg\"}\n\n\t\t_onGuestNotFound: ->\n\n\t\t\t$(\".addressee h2\").html \"Return to sender\"\n\n\t\t_onCardContainerHover: (e) =>\n\n\t\t\tclearTimeout @_forceStart\n\n\t\t\t@_flipEnvelope()\n\n\t\t_flipEnvelope: ->\n\n\t\t\tsetTimeout =>\n\t\t\t\t@_openEnvelope()\n\t\t\t,1000\n\n\t\t\tTweenMax.to \".envelope\", 0.85, {rotationY:180}\n\t\t\tTweenMax.to \".back\", 0, {rotationY:180}\n\n\t\t\t$(\".card-container\").off \"mouseover\"\n\n\t\t_openEnvelope: ->\n\n\t\t\t@_flapAnimation = new TimelineLite()\n\n\t\t\t@_flapAnimation.add TweenMax.to(\".envelope\", 0.5, {y:100})\n\t\t\t.add TweenMax.to(\".card\", 0, {autoAlpha:1})\n\t\t\t.add TweenMax.to(\".flap\", 1, {rotationX:180, transformOrigin:\"0 0\"})\n\t\t\t\n\t\t\tsetTimeout =>\n\t\t\t\tTweenMax.set(\".flap\", {zIndex:10})\n\t\t\t\t@_showCard()\n\t\t\t,2000\n\n\t\t_showCard: ->\n\n\t\t\t@_cardAnimation = new TimelineLite()\n\n\t\t\t@_cardAnimation.add TweenMax.to(\".card\", 0.5, {y:-100, height:\"+=100\"})\n\t\t\t.add TweenMax.to(\".card\", 0.75, {rotation:25, y:-600, delay: 0.5})\n\t\t\t.add TweenMax.set(\".card\", {zIndex:30, boxShadow: \"0 0 10px #999\", delay:0.1})\n\t\t\t.add TweenMax.to(\".card\", 0.5, {y:-130, rotation:0})\n\t\t\t.add TweenMax.to(\".card\", 0.5, {scale:1.2})\n\n\t\t\t# add reset listener\n\t\t\t# $(\"body\").on \"click\", @_reset\n\n\t\t_reset: =>\n\n\t\t\t@_cardAnimation.reverse()\n\t\t\tsetTimeout =>\n\t\t\t\tTweenMax.set(\".flap\", {zIndex:40})\n\t\t\t\t@_flapAnimation.reverse()\n\n\t\t\t\tsetTimeout =>\n\t\t\t\t\tTweenMax.to \".envelope\", 0.85, {rotationY:0}\n\t\t\t\t\tTweenMax.to \".back\", 0, {rotationY:0}\n\n\t\t\t\t\t# remove reset listener\n\t\t\t\t\t$(\"body\").off \"click\"\n\t\t\t\t\t$(\".card-container\").on \"mouseover\", @_onCardContainerHover\n\t\t\t\t,2000\n\t\t\t,2000"],"sourceRoot":"/source/"}